<!DOCTYPE html>
<html>

<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>

    <div id=header>   
        <img id="logo" src="logo.png" width="15%" height="15%">
        <br/>
        <br/>
        the name of our application: pacmanForUs
        <br/>
        <br/>
        presenters: nitzan sabag 205510001, einat kivity 205778772
        <br/> 
        <br/>       
    </div>

    <div id=menu>
        <a class="menuLine" href="#welcome" onclick="welcome()">welcome | </a>
        <a class="menuLine" href="#signUp" onclick="signUp()">signUp | </a>
        <a class="menuLine" href="#login" onclick="login()">login | </a>
        <a class="menuLine" href="#setting" onclick="setting()">setting | </a>
        </li><a class="menuLine" href="#about" onclick="about()">about | </a>
    </div>

    <div id=content>
        <div id=welcome >
            <input type=button onclick="signUp()" value="signUp">
            <input type=button onclick="login()" value="login">
        </div>

        <div id=signUp>
        
            <P><STRONG>userName: </STRONG>
            <INPUT NAME = "userName" TYPE = "text" id="uname" SIZE = "25" required></P>

            <P><STRONG>password: </STRONG>
            <INPUT NAME = "password" TYPE = "text" id="pass" SIZE = "25" required></P>

            <P><STRONG>firstName: </STRONG>
            <INPUT NAME = "firstName" TYPE = "text" id="fname" SIZE = "25" pattern="(?=.*[a-z])(?=.*[A-Z])" required></P>

            <P><STRONG>lastName: </STRONG>
            <INPUT NAME = "lastName" TYPE = "text" id="lname" SIZE = "25" pattern="(?=.*[a-z])(?=.*[A-Z])" required></P>
            
            <P><STRONG>Email Address:</STRONG> 
            <INPUT NAME = "email" TYPE = "text" id="em" SIZE = "25" required></P>

            <P><STRONG>birth date:&emsp;</STRONG>
            <STRONG>year</STRONG><SELECT NAME = "year" id=year>
            <OPTION SELECTED> <OPTION>1980<OPTION>1981<OPTION>1982<OPTION>1983<OPTION>1984<OPTION>1985<OPTION>1986<OPTION>1987<OPTION>1988<OPTION>1989<OPTION>1990<OPTION>1991<OPTION>1992<OPTION>1993<OPTION>1994<OPTION>1995<OPTION>1996<OPTION>1997<OPTION>1998<OPTION>1999
            <OPTION >2000<OPTION>2001<OPTION>2002<OPTION>2003<OPTION>2004<OPTION>2005<OPTION>2006<OPTION>2007<OPTION>2008<OPTION>2009<OPTION>2010<OPTION>2011<OPTION>2012<OPTION>2013<OPTION>2014<OPTION>2015<OPTION>2016<OPTION>2017<OPTION>2018<OPTION>2019
            </SELECT> 
        
            <STRONG>month</STRONG><SELECT NAME = "month" id=month>
            <OPTION SELECTED> <OPTION>1<OPTION>2<OPTION>3<OPTION>4<OPTION>5<OPTION>6<OPTION>7<OPTION>8<OPTION>9<OPTION>10<OPTION>11<OPTION>12
            </SELECT>

            <STRONG>day</STRONG><SELECT NAME = "day" id=day>
            <OPTION SELECTED> <OPTION>1<OPTION>2<OPTION>3<OPTION>4<OPTION>5<OPTION>6<OPTION>7<OPTION>8<OPTION>9<OPTION>10<OPTION>11<OPTION>12<OPTION>13<OPTION>14<OPTION>15
            <OPTION>16<OPTION>17<OPTION>18<OPTION>19<OPTION>20<OPTION>21<OPTION>22<OPTION>23<OPTION>24<OPTION>25<OPTION>26<OPTION>27<OPTION>28<OPTION>29<OPTION>30<OPTION>31
            </SELECT>
            <br/>
            <br/>
            <input type=button onclick="submit()" value="submit">
            </P>

        </div>

        <div id="login">
            <P><STRONG>User name:<input type="text" name="userid" id="userid"></STRONG></P>
            <P><STRONG>User password:<input type="password" name="psw" id="psw"></STRONG></P>
            <br/>
            <input type=button onclick="start_game()" value="start game">
        </div>

        <div id="setting">
            <P><STRONG>game button: </STRONG>
                <br/>
                <INPUT NAME = "left" TYPE = "text" id="left" SIZE = "20" required>
                <INPUT NAME = "right" TYPE = "text" id="right" SIZE = "20" required>
                <INPUT NAME = "up" TYPE = "text" id="up" SIZE = "20" required>
                <INPUT NAME = "down" TYPE = "text" id="down" SIZE = "20" required>
            </P>
    
            <P><STRONG>number of balls: </STRONG>
                <br/>
            <INPUT NAME = "ballsNum" TYPE = "text" id="ballsNum" SIZE = "25" required></P>

            <P><STRONG>color of balls: </STRONG>
                <br/>
                first color, whorth 25 points:<INPUT NAME = "firstColor" TYPE = "text" id="firstColor" SIZE = "10" required>
                second color, whorth 15 points:    <INPUT NAME = "secondColor" TYPE = "text" id="secondColor" SIZE = "10" required>
                third color, whorth 5 points:   <INPUT NAME = "thirdColor" TYPE = "text" id="thirdColor" SIZE = "10" required>
            </P>

            <P><STRONG>time for the game: </STRONG>
                <br/>
                <INPUT NAME = "seconds" TYPE = "text" id="seconds" SIZE = "25" required></p>
            
            <P><STRONG>number of monsters:</STRONG> 
                <br/>
            <INPUT NAME = "monsters" TYPE = "text" id="monsters" SIZE = "25" required></P>

            <input type=button onclick="random()" value="random">
            <br/>
            <br/>
            <input type=button onclick="changeSetting()" value="changeSetting">
        </div>
        
    </div>
    
    <div id=footer>
        
    </div>

    <div id=game>
        <br/>
        <input type=button onclick="stopMusic()" value="stop music">
        <input type=button onclick="playMusic()" value="play music">
        <input type=button onclick="restart()" value="restart">
        <br/> 
        SCORE:
        <input id="lblScore" type="text"/>
        <br/>
        TIME:
        <input id="lblTime" type="text"/>
        <br/>
        USERNAME:
        <input id="lblName" type="text"/>
        <br/>
        NUMBER OF DISQUALIFICATIONS ALLOWD:
        <input id="lblDisq" type="text"/>
        <br/>
        <canvas id="canvas" height="600" width="600"></canvas>
    </div>


<script type="text/javascript">
    var context = canvas.getContext("2d");
    var shape = new Object();
    var smail=new Object();
    var ghost=new Object();
    var secondghost=new Object();
    var thirdghost=new Object();
    var medication=new Object();
    var clock=new Object();
    var heart=new Image();
    var clockImg=new Image();
    heart.src="loveityoyo3.jpg";
    clockImg.src="clock.jpg";
    var board;
    var disq=3;
    var score;
    var pac_color;
    var start_time;
    var time_elapsed;
    var interval;
    var intervalSmail;
    var intervalGhost;
    var intervalMedication;
    var intervalStopMedication;
    var whatWasBefore=0;
    var whatWasBeforeS=0;
    var whatWasBeforeHeart=0;
    var users_arr = [];
    var diraction_pacman;
    //for their test
    users_arr.push('a');
    users_arr.push('a');
    
    var contains = function(needle) {
        var findNaN = needle !== needle;
        var indexOf;

        if(!findNaN && typeof Array.prototype.indexOf === 'function') {
            indexOf = Array.prototype.indexOf;
        } else {
            indexOf = function(needle) {
                var i = -1, index = -1;

                for(i = 0; i < this.length; i++) {
                    var item = this[i];

                    if((findNaN && item !== item) || item === needle) {
                        index = i;
                        break;
                    }
                }

                return index;
            };
        }

        return indexOf.call(this, needle) > -1;
    };

    welcome();

    function checkFieldsToSubmit(){
        if($("#uname").val()==''){
            alert("userName is a required field");
            return false;
        }
        if($("#pass").val()==''){
            alert("password is a required field");
            return false;
        }
        var check=validatePass(document.getElementById("pass").value)
        if(check=="short"){
            alert("This password address is too short");
            return false;
        }
        if(check=="invalid"){
            alert("This password address contains invalid characters");
            return false;
        }
        
        if($("#fname").val()==''){
            alert("firstName is a required field");
            return false;
        }
        var first= validateName(document.getElementById("fname").value)
        if(first=="numbers" || first=="invalid"){
            alert("your first name can not include characters that are different from letters")
            return false;
        }
        
        if($("#lname").val()==''){
            alert("lastName is a required field");
            return false;
        }

        var second= validateName(document.getElementById("lname").value)
        if(second=="numbers" || second=="invalid"){
            alert("your last name can not include characters that are different from letters")
            return false;
        }

        if($("#em").val()==''){
            alert("email is a required field");
            return false;
        }
        if(!validateEmail(document.getElementById("em").value)){
            alert("This email address is invalid");
            return false;
        }

        if($("#year").val()=='' || $("#month").val()=='' || $("#day").val()==''){
            alert("birth date is a required field");
            return false;
        }
        return true;
    
    }

    function validateEmail(email) {
        var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
        return emailReg.test( email );
    }
    function validateName(name) {
        var numbers =/[0-9]/;
        var letters =/[A-Za-z]/;
        var another =/[@$!%*#?&^+|/~><.'";,=/`{}]/;

        var bool1=numbers.test(name)
        var bool2=another.test(name)

        if(bool1)
            return "numbers"
        if(bool2)
            return "invalid"

    }
    function validatePass(pass) {
        console.log(pass)
        var numbers =/[0-9]/;
        var letters =/[A-Za-z]/;
        var another =/[@$!%*#?&^+|/~><.'";,=/`]/;

        var value = $("#pass").val();
        if(value.length<8)
            return "short"

        var bool2=numbers.test(pass)
        var bool=letters.test(pass)
        var bool3=another.test(pass)
        if(bool3)
            return "invalid"
        return "good";
    }
    function drawGhost(center){
        context.beginPath();
        context.fillStyle = "red";
        context.arc(center.x, center.y, 25, Math.PI, 0, false);
        context.moveTo(center.x-25, center.y);
        context.fill();
        context.lineTo(center.x-25, center.y+25-25/4);
        context.lineTo(center.x-25+25/3, center.y+25);
        context.lineTo(center.x-25+25/3*2, center.y+25-25/4);
        context.lineTo(center.x, center.y+25);
        context.lineTo(center.x+25/3, center.y+25-25/4);
        context.lineTo(center.x+25/3*2, center.y+25);
        context.lineTo(center.x+25, center.y+25-25/4);
        context.lineTo(center.x+25, center.y);
        context.fill();
        // EYES
        context.fillStyle = "white"; //left eye
        context.beginPath();
        context.arc(center.x-25/2.5, center.y-25/4, 25/4, 0, Math.PI*2, true); // white
        context.fill();
        context.fillStyle = "white"; //right eye
        context.beginPath();
        context.arc(center.x+25/2.5, center.y-25/4, 25/4, 0, Math.PI*2, true); // white
        context.fill();
        //mouth
        context.beginPath();
        context.lineWidth=1;
        context.moveTo(center.x-20+20/5, center.y+20/2);
        context.lineTo(center.x-20+20/3, center.y+20/4);
        context.lineTo(center.x-20+20/3*2, center.y+20/2);
        context.lineTo(center.x, center.y+20/4);
        context.lineTo(center.x+20/3, center.y+20/2);
        context.lineTo(center.x+20/3*2, center.y+20/4);
        context.lineTo(center.x+20-20/5, center.y+20/2);
        context.stroke();
            //eyeball Center
        context.fillStyle="black"; //left eyeball
        context.beginPath();
        context.arc(center.x-25/2.5, center.y-25/4, 25/7, 0, Math.PI*2, true); //black
        context.fill(); 
        context.fillStyle="black"; //right eyeball
        context.beginPath();
        context.arc(center.x+25/2.5, center.y-25/4, 25/7, 0, Math.PI*2, true); //black
        context.fill();
    }

    function drawPacman(center){
        context.beginPath();
        context.arc(center.x, center.y, 30, 0.15 * Math.PI, 1.85 * Math.PI); // half circle
        context.lineTo(center.x, center.y);
        context.fillStyle = pac_color; //color
        context.fill();
        context.beginPath();
        context.arc(center.x + 5, center.y - 15, 5, 0, 2 * Math.PI); // circle
        context.fillStyle = "black"; //color
        context.fill();
        switch(diraction_pacman){
            case 1: //up
            context.beginPath();
            context.arc(center.x, center.y, 30, 0.15 * Math.PI + Math.PI, 1.85 * Math.PI + Math.PI); // half circle
            context.lineTo(center.x, center.y);
            context.fillStyle = "white"; //color
            context.fill();
            context.beginPath();
            context.arc(center.x, center.y, 30, 0.15 * Math.PI - Math.PI/2, 1.85 * Math.PI - Math.PI/2); // half circle
            context.lineTo(center.x, center.y);
            context.fillStyle = pac_color; //color
            context.fill();
            context.beginPath();
            context.arc(center.x + 15, center.y - 5, 5, 0, 2 * Math.PI); // circle
            context.fillStyle = "black"; //color
            context.fill();
            break
            
            case 2: //down
            context.beginPath();
            context.arc(center.x, center.y, 30, 0.15 * Math.PI + Math.PI, 1.85 * Math.PI + Math.PI); // half circle
            context.lineTo(center.x, center.y);
            context.fillStyle = "white"; //color
            context.fill();
            context.beginPath();
            context.arc(center.x, center.y, 30, 0.15 * Math.PI + Math.PI/2, 1.85 * Math.PI + Math.PI/2); // half circle
            context.lineTo(center.x, center.y);
            context.fillStyle = pac_color; //color
            context.fill();
            context.beginPath();
            context.arc(center.x + 15, center.y + 5, 5, 0, 2 * Math.PI); // circle
            context.fillStyle = "black"; //color
            context.fill();
            break;

            case 3: //left
            context.beginPath();
            context.arc(center.x, center.y, 30, 0.15 * Math.PI, 1.85 * Math.PI); // half circle
            context.lineTo(center.x, center.y);
            context.fillStyle = "white"; //color
            context.fill();
            context.beginPath();
            context.arc(center.x, center.y, 30, 0.15 * Math.PI + Math.PI, 1.85 * Math.PI + Math.PI); // half circle
            context.lineTo(center.x, center.y);
            context.fillStyle = pac_color; //color
            context.fill();
            context.beginPath();
            context.arc(center.x - 5, center.y -15, 5, 0, 2 * Math.PI); // circle
            context.fillStyle = "black"; //color
            context.fill();
            //co.arc(this.x, this.y, this.radius, 2*Math.PI-Math.PI*7/9, 2*Math.PI-Math.PI*2/9, true);
            break;

            case 4:
            context.beginPath();
            context.arc(center.x, center.y, 30, 0.15 * Math.PI, 1.85 * Math.PI); // half circle
            context.lineTo(center.x, center.y);
            context.fillStyle = pac_color; //color
            context.fill();
            context.beginPath();
            context.arc(center.x + 5, center.y - 15, 5, 0, 2 * Math.PI); // circle
            context.fillStyle = "black"; //color
            context.fill();
            break;

            default:
            break;

        }
        
    }
    // function drawMedication(i,j){
    //     context.drawImage(heart,60*i,60*j,60,60);
    // }

    // function drawClock(i,j){
    //     context.drawImage(clockImg,60*i,60*j,60,60);
    // }

    function drawSmiley(center){
        context.beginPath();
        context.arc(center.x,center.y,25,0,Math.PI*2,true);
        context.fillStyle="pink";
        context.fill();
        context.beginPath();
        context.arc(center.x-10,center.y-10,5,0,Math.PI*2,true);  
        context.fillStyle="black";
        context.fill();
        context.beginPath();
        context.arc(center.x+12,center.y-10,5,0,Math.PI*2,true);  
        context.fillStyle="black";
        context.fill();
        context.beginPath();
        context.arc(center.x-10,center.y-8,2,0,Math.PI*2,true);
        context.fillStyle="white";
        context.fill();
        context.beginPath();
        context.arc(center.x+12,center.y-8,2,0,Math.PI*2,true);
        context.fillStyle="white";
        context.fill();
        context.beginPath();
        context.lineWidth=2;
        //context.moveTo(center.x-10, center.y+7);
        context.arc(center.x, center.y+3, 17, 0, Math.PI, false);
        context.stroke();
    }
    function gameOver(){
        window.clearInterval(interval);
        window.clearInterval(intervalSmail);
        window.clearInterval(intervalGhost);
        window.clearInterval(intervalMedication);  
        window.clearInterval(intervalClock);
        window.clearInterval(intervalStopMedication);
        myMusic.stop();
        window.alert("You lost!");
    }

    function restart(){//////////////////////no succsed
        //context.clearRect(0, 0, canvas.width, canvas.height);
        window.clearInterval(interval);
        window.clearInterval(intervalSmail);
        window.clearInterval(intervalGhost);
        window.clearInterval(intervalMedication);
        window.clearInterval(intervaClock);
        window.clearInterval(intervalStopMedication);
        window.clearInterval(intervalStopClock);
        myMusic.stop();
        //location.href.reload(Start);
        //document.getElementById("#canvas").innerHTML="";
        Start();
    }

    function randomPacman(){
        disq--;
    
        if(disq === 0){
            lblDisq.value = disq;
            gameOver();
        }
        var added = false;
        while(added === false){
            var y = Math.floor(Math.random() * 10);  
            var x = Math.floor(Math.random() * 10);  
            shape.i = x;
            shape.j = y;
            board[x][y] = 2;
            if(board[x][y] !== 4 && board[x][y] !== -1 && board[x][y] !== 5){
                added = true;
            }
        }
    }
    //**********
    function random(){
        //***Change this to random!!!
        var doc_val_check =$("#firstColor").val(doc_val_check);
        doc_val_check = getRandomColor(); 
        console.log(document.getElementById("firstColor").value);
        var doc_val_check =$("#secondColor").val(doc_val_check);
        doc_val_check =getRandomColor(); 
        console.log(document.getElementById("secondColor").value);
        var doc_val_check =$("#thirdColor").val(doc_val_check);
        doc_val_check = getRandomColor(); 
        console.log(document.getElementById("thirdColor").value);

        var doc_val_check =$("#down").val(doc_val_check);
        doc_val_check = "ArrowDown"; 
        var doc_val_check =$("#right").val(doc_val_check);
        doc_val_check = "ArrowRight"; 
        
        var doc_val_check =$("#up").val(doc_val_check);
        doc_val_check = "ArrowUp"; 
        
        var doc_val_check =$("#left").val(doc_val_check);
        doc_val_check = "ArrowLeft"; 
        console.log(document.getElementById("left").value); 
        
        
        var random = Math.random();
        while(random < 10)
            random = random * 10
        random = parseInt(random);
        console.log(random+" randommmmmm");
        var doc_val_check =$("#ballsNum").val(doc_val_check);
        if (random < 50) 
            doc_val_check = 50; 
        if(random > 90)
            doc_val_check = 90; 
        if(50 <= random && random <= 90)
            doc_val_check = random; 
        console.log(document.getElementById("ballsNum").value);
        var random = Math.random();
        while(random < 10)
            random = random * 10
        random = parseInt(random);
        var doc_val_check =$("#seconds").val(doc_val_check);
        if (random < 60) {
            doc_val_check = 60; 
        }
        if(random > 90)
            doc_val_check = random;
        console.log(document.getElementById("seconds").value);
        var random = Math.random();
        while(random < 10)
            random = random * 10
        random = parseInt(random);
        var doc_val_check =$("#monsters").val(doc_val_check);
        if (random < 40)
            doc_val_check = "1"; 
        if (random >= 40 && random < 70)
            doc_val_check = "2"; 
        if (random >= 70)
            doc_val_check = "3"; 
        console.log(document.getElementById("monsters").value);
    }

    function Start() {
        var w = document.getElementById("game");
        //if (w.style.display === "none") {
        w.style.display = "block";
        //} else {
        //     w.style.display = "none";
        // }
        var y = document.getElementById("welcome");
            y.style.display = "none";
        var x = document.getElementById("login");
            x.style.display = "none";
        var z = document.getElementById("signUp");
            z.style.display = "none";
        lblName.value = document.getElementById("userid").value;
        board = new Array();
        score = 0;
        pac_color = "yellow";
        var cnt = 100;
        var food_remain =60;
        var pacmanAdded=false;
        var pacman_remain = 1;  
        medication.i=0;
        medication.j=0;
        clock.i=0;
        clock.j=0;
        var firstCounter=parseInt(food_remain*0.1);
        var secondCounter=parseInt( food_remain*0.3);
        var thirdCounter=parseInt( food_remain*0.6);
        console.log(firstCounter+" , "+secondCounter+" , "+thirdCounter);
        food_remain=firstCounter+secondCounter+thirdCounter;
        console.log(food_remain+"  foooood");
        start_time = new Date();
        for (var i = 0; i < 10; i++) {
            board[i] = new Array();
            //put obstacles in (i=3,j=3) and (i=3,j=4) and (i=3,j=5), (i=6,j=1) and (i=6,j=2)
            for (var j = 0; j < 10; j++) {
                if ((i === 3 && j === 3) || (i === 3 && j === 4) || (i === 3 && j === 5) || (i === 6 && j === 1) || (i === 6 && j === 2)) {
                    board[i][j] = 4;
                }
                else if((i===0 && j===0)|| (i===0 && j===9)|| (i===9 && j===0)|| (i===9 && j===9)){
                    continue;
                }
                else {
                    var randomNum = Math.random();
                    if (randomNum <= 1.0 * food_remain / cnt) {   
                        var toReturn=putBall(i,j,firstCounter,secondCounter,thirdCounter);
                        if(toReturn==="first")
                            firstCounter--;
                        if(toReturn==="second")
                            secondCounter--;
                        if(toReturn==="third")
                            thirdCounter--;
                        food_remain--;       
                    } else if (randomNum < 1.0 * (pacman_remain + food_remain) / cnt) {
                        shape.i = i;
                        shape.j = j;
                        pacman_remain--;
                        board[i][j] = 2;
                        pacmanAdded=true;
                    } else {
                        board[i][j] = 0;
                    }
                    cnt--;
                }
            }
        }
        board[0][0]=5
        smail.i=0;
        smail.j=0;
        
        board[0][9]=-1;
        ghost.i=0;
        ghost.j=9;
        // var numberOfMonsters=document.getElementById("#monsters").value-1;
        // while(numberOfMonsters>0){
        //     if(numberOfMonsters===2){
        //         board[9][0]=-1;
        //         secondghost.i=9;
        //         secondghost.j=0;
        //     }
        //     else{
        //         board[9][9]=-1;
        //         thirdghost.i=9;
        //         thirdghost.j=9;
        //     }
        //     numberOfMonsters--;
        // }
       
        if(pacmanAdded===false){
            var emptyCell = findRandomEmptyCell(board);
            board[emptyCell[0]][emptyCell[1]]=2;
            shape.i=emptyCell[0];
            shape.j=emptyCell[1];
        }
        while (food_remain > 0) {
            var emptyCell = findRandomEmptyCell(board);
            var toReturn=putBall(emptyCell[0],emptyCell[1],firstCounter,secondCounter,thirdCounter);
            if(toReturn==="first")
                firstCounter--;
            if(toReturn==="second")
                secondCounter--;
            if(toReturn==="third")
                thirdCounter--;
            food_remain--;
            
        }
        
        console.log(firstCounter+" , "+secondCounter+" , "+thirdCounter);
        keysDown = {};
        console.log(board[0][0]+"jjjjjj");
        addEventListener("keydown", function (e) {
            keysDown[e.code] = true;
        }, false);
        addEventListener("keyup", function (e) {
            keysDown[e.code] = false;
        }, false);
        interval = setInterval(UpdatePosition, 250);
        intervalSmail=setInterval(moveSmail,500);
        intervalGhost=setInterval(moveGhoust,500);
        intervalMedication=setInterval(addMedication,9000);
        intervalStopMedication=setInterval(stopMedication,11000);
        intervalClock=setInterval(addClock,7000);
        intervalStopClock=setInterval(stopClock,9000);
        myMusic = new sound("mns_zelmerlw_-_heroes_evrovidenie_2015_shvecija_(zvukoff.ru).mp3");
        myMusic.play(); 
        winMusic = new sound("Queen-We-Are-The-Champions-cut.mp3");
       
    }
    function stopMedication(){
        board[medication.i][medication.j]=0;
    }

    function stopClock(){
        board[clock.i][clock.j]=0;
    }

    function addMedication(){
        var finish=false;

        while(finish===false){
            var i=Math.random();
        var j=Math.random();
            while(i<1){
                i=i*10;
            }
            while(j<1){
                j=j*10;
            }
            i=parseInt(i);
            j=parseInt(j);
            if(board[i][j]!=2 && board[i][j]!=5 && board[i][j]!=-1 && board[i][j]!=8 && board[i][j]!=9 && board[i][j]!=10 && board[i][j]!=4){
                if(board[medication.i][medication.j]===20){
                    board[medication.i][medication.j]=0;
                }
                board[i][j]=20;
                medication.i=i;
                medication.j=j;
                finish=true;
            }
        }
    }

    function addClock(){
        var finish=false;

        while(finish===false){
            var i=Math.random();
        var j=Math.random();
            while(i<1){
                i=i*10;
            }
            while(j<1){
                j=j*10;
            }
            i=parseInt(i);
            j=parseInt(j);
            if(board[i][j]!=2 && board[i][j]!=5 && board[i][j]!=-1 && board[i][j]!=8 && board[i][j]!=9 && board[i][j]!=10 && board[i][j]!=4){
                if(board[clock.i][clock.j]===30){
                    board[clock.i][clock.j]=0;
                }
                board[i][j]=30;
                clock.i=i;
                clock.j=j;
                finish=true;
            }
        }
    }

    function putBall(i,j, firstCounter,secondCounter,thirdCounter){

        var random = Math.floor(Math.random() * (10 - 1) ) + 1;
        //console.log(random);
        if(random < 4){
            if(firstCounter > 0){
                board[i][j] = 8;
                return "first";
            }
            else{
                random = Math.floor(Math.random() * (10 - 0) ) + 0;
                //console.log(random+" fiiiiiiiiiiiirst")
                if(random < 5){
                    if(secondCounter > 0){
                    board[i][j] = 9;
                    return "second";
                    }
                    else{
                        board[i][j] = 10;
                        return "third"
                    }
                }
                else{
                    if(thirdCounter >0){
                    board[i][j] = 10;
                    return "third";
                    }
                    else{
                        board[i][j] = 9;
                        return "second"
                    }
                }
            }
        }

        if(4 <= random && random < 7){
            if(secondCounter > 0){
                board[i][j] = 9;
                return "second";
            }
            else{
                random = Math.floor(Math.random() * (10 - 0) ) + 0;
                //console.log(random+" seconddddddddddddd")
                if(random < 5){
                    if(thirdCounter > 0){
                    board[i][j] = 10;
                    return "third";
                    }
                    else{
                        board[i][j] = 8;
                        return "first"
                    }
                }
                else{
                    if(firstCounter > 0){
                    board[i][j] = 8;
                    return "first";
                    }
                    else{
                        board[i][j] = 10;
                        return "third"
                    }
                }
            }
        }
        if(7 <= random && random < 10){
            if(thirdCounter > 0){
                board[i][j] = 10;
                return "third";
            }
            else{
                random = Math.floor(Math.random() * (10 - 0) ) + 0;
                //console.log(random+" thirdddddddddddddddd")
                if(random < 5){
                    if(firstCounter > 0){
                    board[i][j] = 8;
                    return "first";
                    }
                    else{
                        board[i][j] = 9;
                        return "second"
                    }
                }
                else{
                    if(secondCounter > 0){
                    board[i][j] = 9;
                    return "second";
                    }
                    else{
                        board[i][j] = 8;
                        return "first"
                    }
                }
            }
        }
    }

    function stopMusic(){
        myMusic.stop();
    }
    function playMusic(){
        myMusic.play();
    }

    function sound(src) {
    this.sound = document.createElement("audio");
    this.sound.src = src;
    this.sound.setAttribute("preload", "auto");
    this.sound.setAttribute("controls", "none");
    this.sound.style.display = "none";
    document.body.appendChild(this.sound);
        this.play = function(){
            this.sound.play();
        }
        this.stop = function(){
            this.sound.pause();
        }    
    }

    function start_game(){
        var name = document.getElementById("userid").value;
        var password = document.getElementById("psw").value;
        if(contains.call(users_arr, name)){
            var index = users_arr.indexOf(name);
            if(users_arr[index + 1] == password){
                //console.log("user name: " + users_arr[index] + "paa: " + users_arr[index + 1]);
                Start();
            }
            else{
                alert("password incorrect");
            }
        }
        else{
            alert("user name not exist. Please sign up first");
        }
        var doc_val_check =$("#userid").
        
        
        val(doc_val_check);
        if (doc_val_check.length) {
            doc_val_check = ""; 
        }
        var doc_val_check =$("#psw").val(doc_val_check);
        if (doc_val_check.length) {
            doc_val_check = ""; 
        }
        
    }

    function moveGhoust(){
        if(whatWasBefore===0){
            board[ghost.i][ghost.j] = 0;
        }
        if(whatWasBefore===8){
            board[ghost.i][ghost.j] = 8;
        }
        if(whatWasBefore===9){
            board[ghost.i][ghost.j] = 9;
        }
        if(whatWasBefore===10){
            board[ghost.i][ghost.j] = 10;
        }
        if(whatWasBefore===5){
            board[ghost.i][ghost.j] = 0;
        }
        if(whatWasBefore===20){
            board[ghost.i][ghost.j] = 0;
        }
        if(whatWasBefore===-1){
            board[ghost.i][ghost.j] = 0;
        }

        //console.log(ghost.i +" ......... "+ ghost.j);
        //console.log(forTheSmail)
        var add = false;
        while(add === false){
            var forTheGhoust = Math.random();
            if(forTheGhoust <= 0.25){//down
                if(ghost.i < 9 && board[ghost.i + 1][ghost.j] !== 4 && board[ghost.i + 1][ghost.j] !== 1){
                    ghost.i++;
                    add = true;
                    //console.log("down");
                }
            }

            if(0.25<forTheGhoust && forTheGhoust<=0.5){//left
                if(ghost.j<9 && board[ghost.i][ghost.j+1] !== 4 && board[ghost.i][ghost.j+1] !== 1){
                    ghost.j++;
                    add=true;
                    //console.log("left");
                }
            }

            if(0.5<forTheGhoust && forTheGhoust<=0.75){//up
                if(ghost.i>0 && board[ghost.i - 1][ghost.j] !== 4 && board[ghost.i - 1][ghost.j] !== 1){
                    ghost.i--;
                    add=true;
                    //console.log("up");
                }
            }

            if(0.75<forTheGhoust && forTheGhoust<=1){//right
                if(ghost.j>0 && board[ghost.i][ghost.j-1] !== 4 && board[ghost.i][ghost.j-1] !== 1){
                    ghost.j--;
                    add=true;
                   //console.log("right");
                }
            }
        }
        // if(  board[ghost.i][ghost.j] = 2){
        //     randomPacman();
        // }
        whatWasBefore=board[ghost.i][ghost.j];
        board[ghost.i][ghost.j] = -1;

    }

    function moveSmail(){
        if(whatWasBeforeS === 0){
            board[smail.i][smail.j] = 0;
        }
        if(whatWasBeforeS === 8){
            board[smail.i][smail.j] = 8;
        }
        if(whatWasBeforeS === 9){
            board[smail.i][smail.j] = 9;
        }
        if(whatWasBeforeS === 10){
            board[smail.i][smail.j] = 10;
        }
        if(whatWasBeforeS === -1){
            board[smail.i][smail.j] = 0;
        }
        if(whatWasBeforeS === 2){
            board[smail.i][smail.j] = 0;
        }
        if(whatWasBeforeS === 20){
            board[smail.i][smail.j] = 0;
        }
        if(whatWasBeforeS === 5){
            board[smail.i][smail.j] = 0;
        }
        var add=false;
        while(add===false){
            var forTheSmail = Math.random();
            if(forTheSmail<=0.25){//down
                    if(smail.i<9 && board[smail.i + 1][smail.j] !== 4 && board[smail.i + 1][smail.j] !== 1){
                        smail.i++;
                        add=true;
                        //console.log("down");
                    }
            }

            if(0.25<forTheSmail && forTheSmail<=0.5){//left
                    if(smail.j<9 && board[smail.i][smail.j+1] !== 4 && board[smail.i][smail.j+1] !== 1){
                        smail.j++;
                        add=true;
                        //console.log("left");
                    }
            }

            if(0.5<forTheSmail && forTheSmail<=0.75){//up
                    if(smail.i>0 && board[smail.i - 1][smail.j] !== 4 && board[smail.i - 1][smail.j] !== 1){
                        smail.i--;
                        add=true;
                        //console.log("up");
                    }
            }

            if(0.75<forTheSmail && forTheSmail<=1){//right
                if(smail.j>0 && board[smail.i][smail.j-1] !== 4 && board[smail.i][smail.j-1] !== 1){
                    smail.j--;
                    add=true;
                    //console.log("right");
                }
            }
        }
        whatWasBeforeS=board[smail.i][smail.j];
        board[smail.i][smail.j] = 5;

    }

    function UpdatePosition() {
        board[shape.i][shape.j] = 0;
        var x = GetKeyPressed();
        if (x === 1) {
            if (shape.j > 0 && board[shape.i][shape.j - 1] !== 4) {
                shape.j--;
            }
            diraction_pacman = 1;
        }
        if (x === 2) {
            if (shape.j < 9 && board[shape.i][shape.j + 1] !== 4) {
                shape.j++;
            }
            diraction_pacman = 2;
        }
        if (x === 3) { //left
            if (shape.i > 0 && board[shape.i - 1][shape.j] !== 4) {
                shape.i--;
            }
            diraction_pacman = 3;
        }
        if (x === 4) {
            if (shape.i < 9 && board[shape.i + 1][shape.j] !== 4) {
                shape.i++;
            }
            diraction_pacman = 4;
        }

        if (board[shape.i][shape.j] === 8) {
            score = score + 25;;
        }
        if (board[shape.i][shape.j] === 9) {
            score = score + 15;;
        }
        if (board[shape.i][shape.j] === 10) {
            score = score + 5;
        }
        if(board[shape.i][shape.j] === 5){
            score = score + 50;
            moveSmail();
        }
        if(board[shape.i][shape.j] === -1){
            score = score - 10;
            randomPacman();
        }
        if(board[shape.i][shape.j] === 20){
            disq++;
        }
        if(board[shape.i][shape.j] === 30){
            time_elapsed=time_elapsed-15;
        }

        board[shape.i][shape.j] = 2;
        var currentTime = new Date();
        time_elapsed = (currentTime - start_time) / 1000;
        if (score >= 20 && time_elapsed <= 10) {
            pac_color = "green";
        }
        if (score === 50) {
            gameCompleted();
        } else {
            Draw();
        }

        if(document.getElementById("seconds").value-time_elapsed===0){
            window.clearInterval(interval);
            window.clearInterval(intervalSmail);
            window.clearInterval(intervalGhost);
            window.clearInterval(intervalMedication);
            window.clearInterval(intervalClock);
            window.clearInterval(intervalStopMedication);
            window.clearInterval(intervalStopClock);
            myMusic.stop();
            timeIsUp();
        }
    }

    function timeIsUp(){
        if(score < 150){
            window.alert("You can do better");
        }
        else{
            // winMusic.play();
            // window.alert("We have a Winner!!!");
            gameCompleted();
        }
    }

    function getRandomColor() {
        var letters = '0123456789ABCDEF';
        var color = '#';
        for (var i = 0; i < 6; i++) {
            color += letters[Math.floor(Math.random() * 16)];
        }
        return color;
    }

    function gameCompleted(){
        window.clearInterval(interval);
        window.clearInterval(intervalSmail);
        window.clearInterval(intervalGhost);
        window.clearInterval(intervalMedication);
        window.clearInterval(intervalClock);
        window.clearInterval(intervalStopMedication);
        window.clearInterval(intervalStopClock);
        myMusic.stop();
        winMusic.play();
        window.alert("Game completed");
    }

    function welcome(){
        var w = document.getElementById("welcome");
        w.style.display = "block";
        var z = document.getElementById("signUp");
        z.style.display = "none";
        var y = document.getElementById("game");
        y.style.display = "none";
        var x = document.getElementById("login");
        x.style.display = "none";
        var s = document.getElementById("setting");
        s.style.display = "none";

        
    }

    function signUp(){
        var w = document.getElementById("signUp");
        if (w.style.display === "none") {
            w.style.display = "block";
        } else {
            w.style.display = "none";
        }
        var y = document.getElementById("welcome");
            y.style.display = "none";
        var x = document.getElementById("login");
            x.style.display = "none";
        var z = document.getElementById("game");
            z.style.display = "none";
        var s = document.getElementById("setting");
        s.style.display = "none";

    }

    function login(){
        diraction_pacman = 4;
        var w = document.getElementById("login");
        w.style.display = "block";
        var y = document.getElementById("welcome");
        y.style.display="none";
        var x = document.getElementById("signUp");
        x.style.display="none";
        var z = document.getElementById("game");
        z.style.display="none";
        var s = document.getElementById("setting");
        s.style.display="none";
        
    }

    function setting(){
        var s = document.getElementById("setting");
        s.style.display = "block";
        var w = document.getElementById("login");
        w.style.display = "none";
        var y = document.getElementById("welcome");
        y.style.display="none";
        var x = document.getElementById("signUp");
        x.style.display="none";
        var z = document.getElementById("game");
        z.style.display="none";
        
    }

    function submit(){
        
        var bool =checkFieldsToSubmit();
        if(!bool)
            return;
            
        var name = document.getElementById("uname").value;
        var password = document.getElementById("pass").value;
        users_arr.push(name);
        users_arr.push(password);

        var doc_val_check =$("#pass").val(doc_val_check);
        if (doc_val_check.length) {
            doc_val_check = ""; 
        }
        var doc_val_check =$("#uname").val(doc_val_check);
        if (doc_val_check.length) {
            doc_val_check = ""; 
        }
        var doc_val_check =$("#lname").val(doc_val_check);
        if (doc_val_check.length) {
            doc_val_check = ""; 
        }
        var doc_val_check =$("#fname").val(doc_val_check);
        if (doc_val_check.length) {
            doc_val_check = ""; 
        }
        var doc_val_check =$("#em").val(doc_val_check);
        if (doc_val_check.length) {
            doc_val_check = ""; 
        }
        var doc_val_check =$("#year").val(doc_val_check);
        if (doc_val_check.length) {
            doc_val_check = ""; 
        }
        var doc_val_check =$("#month").val(doc_val_check);
        if (doc_val_check.length) {
            doc_val_check = ""; 
        }
        var doc_val_check =$("#day").val(doc_val_check);
        if (doc_val_check.length) {
            doc_val_check = ""; 
        }
        
        var x = document.getElementById("welcome");
        x.style.display="block";

        var y = document.getElementById("signUp");
        y.style.display="none";
    }


    function findRandomEmptyCell(board) {
        var i = Math.floor((Math.random() * 9) + 1);
        var j = Math.floor((Math.random() * 9) + 1);
        while (board[i][j] !== 0) {
            i = Math.floor((Math.random() * 9) + 1);
            j = Math.floor((Math.random() * 9) + 1);
        }
        return [i, j];
    }

    /**
     * @return {number}
     */
    function GetKeyPressed() {
        if (keysDown['ArrowUp']) {
            return 1;
        }
        if (keysDown['ArrowDown']) {
            return 2;
        }
        if (keysDown['ArrowLeft']) {
            return 3;
        }
        if (keysDown['ArrowRight']) {
            return 4;
        }
    }

    function Draw() {
        context.clearRect(0, 0, canvas.width, canvas.height); //clean board
        lblScore.value = score;
        lblTime.value = time_elapsed;
        lblDisq.value = disq;
        for (var i = 0; i < 10; i++) {
            for (var j = 0; j < 10; j++) {
                var center = new Object();
                center.x = i * 60 + 30;
                center.y = j * 60 + 30;
                if(board[i][j] === -1){ //Ghost
                    drawGhost(center);
                }
                if (board[i][j] === 2) { //Pacman
                    drawPacman(center);
                } else if (board[i][j] === 8) {
                    context.beginPath();
                    context.arc(center.x, center.y, 15, 0, 2 * Math.PI); // circle
                    context.fillStyle = "black"; //color
                    context.fill();
                } else if (board[i][j] === 9) {
                    context.beginPath();
                    context.arc(center.x, center.y, 15, 0, 2 * Math.PI); // circle
                    context.fillStyle = "red"; //color
                    context.fill();
                } else if (board[i][j] === 10) {
                    context.beginPath();
                    context.arc(center.x, center.y, 15, 0, 2 * Math.PI); // circle
                    context.fillStyle = "green" //color
                    context.fill();
                } else if (board[i][j] === 4) {
                    context.beginPath();
                    context.rect(center.x - 30, center.y - 30, 60, 60);
                    context.fillStyle = "grey"; //color
                    context.fill();
                }
                else if(board[i][j] === 5){
                   drawSmiley(center); 
                }
                // else if(board[i][j]===20){
                //     drawMedication(i,j);
                // }
                // else if(board[i][j]===30){
                //     drawClock(i,j);
                // }
            }
        }
    }

</script>
</body>

</html>